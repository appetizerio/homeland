<% if !@article.user.blank? %>

    <%= render "topic_author_info" %>

<%end%>

<div id="topic-sidebar">
  <div class="panel panel-default">
    <div class="panel-body">
      <a href="#" class="btn btn-block btn-sm btn-move-page" data-type="top"><i class="fa fa-arrow-up"></i></a>
      <div class="buttons">
        <div class="group likes opts">
          <%= likeable_tag(@article) %>
        </div>
        <div class="group">
          <div class="btn-group" role="group">
            <%= topic_follow_tag(@article, class: 'btn btn-default') %>
            <% if !owner?(@article) %>
              <%= topic_favorite_tag(@article, class: 'btn btn-default') %>
            <% end %>
          </div>
        </div>
      </div>
      <hr />
      <div class="group">
        <%= social_share_button_tag h("#{@article.title}") %>
      </div>
      <hr />
      <div class="reply-buttons">
        <div class="total">
          共收到 <b><%= @article.replies_count %></b> 条回复
        </div>
        <%= reward_user_tag(@article.user) %>
      </div>
      <hr />
      <div class="group opts">
        <% if admin? %>
          <div style="margin-bottom: 8px">
            <% if !@article.suggested_at.blank? %>
            <%= link_to raw("<i class='fa fa-thumb-tack'></i> 取消"), unsuggest_admin_topic_path(@article), method: :post, remote: true %>
            <% else %>
            <%= link_to raw("<i class='fa fa-thumb-tack'></i> 置顶"), suggest_admin_topic_path(@article), method: :post, remote: true %>
            <% end %>
            <% if !@article.excellent? %>
            <%= link_to raw("<i class='fa fa-diamond'></i> 加精"), action_topic_path(@article, type: 'excellent'), method: "post", remote: true %>
            <% end %>
            <% if @article.node_id != Node.no_point.id %>
              <%= link_to raw("<i class='fa fa-ban'></i> 屏蔽"), ban_topic_path(@article), remote: true, title: "屏蔽此贴，移动到 NoPoint 节点" %>
            <% end %>
          </div>
        <% end %>

        <% if owner?(@article) or admin? %>
        <div>
          <% if can?(:close, @article) %>
            <% if !@article.closed? %>
              <%= link_to raw("<i class='fa fa-check'></i> 结束"), action_topic_path(@article, type: 'close'), method: 'post', title: "关闭讨论／问题已解决", remote: true, data: { toggle: 'tooltip' } %>
            <% else %>
              <%= link_to raw("<i class='fa fa-undo'></i> 开启"), action_topic_path(@article, type: 'open'), method: 'post', title: "重新开启话题", remote: true, data: { toggle: 'tooltip' } %>
            <% end %>
          <% end %>
          <%= link_to raw('<i class="fa fa-pencil"></i> 编辑'), edit_topic_path(@article), title: "修改本帖" %>
          <% if can?(:destroy, @article) %>
            <%= link_to raw('<i class="fa fa-trash"></i> 删除'), topic_path(@article.id), method: :delete, 'data-confirm' => t("common.confirm_delete"), title: "删除本帖", remote: true %>
          <% end %>
        </div>
        <% end %>
      </div>
      <a href="#" class="btn btn-block btn-move-page" data-type="bottom"><i class="fa fa-arrow-down"></i></a>
    </div>
  </div>

  <div class="notify-updated">
    <a class="update" href="#"><i class="fa fa-bell-o"></i> <b>有新回复！</b>点击这里立即载入</a>
  </div>
</div>
